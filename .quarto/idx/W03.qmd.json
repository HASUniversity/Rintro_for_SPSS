{"title":"T-tests","markdown":{"headingText":"T-tests","containsRefs":false,"markdown":"\nThere are three types of t-tests:\n\n* One sample t-test\n* Paired t-test\n* Independent t-test\n\nAll three tests can be applied with one function `t.test()`, thanks to the possibility of multiple arguments in one function.\n\nIn the next section we need the data set bodytemp, which you already imported.\n\n\n## One-sample t-test\n\nThe simplest version of a t-test is when you want to test if the average of a single population is different from a theoretical value.\nSo, you collect a **random** sample from a population, e.g. the body temperature of 130 students.\n\nThe next step is to define your hypotheses:\n\n> H~0~: Temperature is not different from 37 degrees Celsius.\n> H~1~: Temperature is different from 37 degrees Celsius.\n\nThe general idea is that human's body temperature is on average 37 degrees Celsius, hence this H~0~.\nThe symbol for the population average is $\\mu$, pronounced as mu.\n\nThird step is testing the hypothesis with the function `t.test(x, mu = ..)`.\n\nFor a one-sample t-test (as we need now), the first argument should be a vector, containing the **sample** to be tested.\nThe other argument needed is mu, which is $\\mu$ from the H~0~.\nNB: mu is not second in row in the list of possible arguments, therefore you need to name it in your code followed by `=` and the value.\n\nThe output gives a lot of information.\nMost important, for hypothesis testing, is the p-value.\nP-values less than the threshold $\\alpha$ (often 0.05) means that you reject the H~0~ and accept the H~1~. \nBut also usefull is the 95% confidence interval.\nIt shows the lower and upper limit where, with 95% confidence, of the real average.\n\n\n::: {#exr-vectors2}\n\nVectors and data frames\n\n* refresh your memory about vectors and data frames. How can you call a vector from a data frame?\n\n:::\n\n\n::: {#exr-onesttest}\n\nOne sample t-test\n\n* Test with a one-sample t-test if the average body temperature deviates from 37 degrees celsius (add the code to your script.\n* Write down your conclusions as a comment in the script.\n\n:::\n\n\n### One sided and two sided tests\n\nWith a t-test you can test one and two sided.\nThe default setting in the function `t.test()` is two sided.\nBut there are situations you want to test if the average value is **lower** than a certain value.\nYour H~1~ is then: $\\mu$ < 37.\nBy giving the argument **alternative** the value **less**, you test one sided.\nIn the situation you want to test $\\mu$ > 37, you need to use the value **greater**.\n\n\n::: {#exr-onesided}\n\nTesting one sided\n\n* copy your t.test code to a new row and adjust it so it will test if $\\mu$ < 37.\n* Compare the outcome \n\n:::\n\n\n### Climate change\n\nIn the last years the role of humans in climate change is becoming more clear.\nThat is ilustrated in below figure, showing the week average in the Bilt in the period before 1950 and from 2000 (data: KNMI).\n\n```{r, echo = FALSE, message=FALSE, warning=FALSE}\nlibrary(readxl)\nlibrary(tidyverse)\ntheme_set(theme_classic(base_size=15))\n\ndf <- read_excel(\"../Data/meantemp_Bilt.xlsx\")\n```\n\n```{r, echo=FALSE, message=FALSE, warning=FALSE}\npre1950 <- df %>% \n  filter(year<1950) %>% \n  group_by(weeknumber) %>% \n  summarise(pre1950 = mean(TG/10))\n\nafter2000 <- df %>% \n  filter(year>1999) %>% \n  group_by(weeknumber) %>% \n  summarise(after2000 = mean(TG/10))\n\nfull_join(pre1950, after2000) %>%\n  pivot_longer(-weeknumber, names_to = \"timeframe\", \n               values_to = \"mean_temp\") %>% \n  ggplot(aes(weeknumber, mean_temp, color = timeframe)) +\n  geom_line(size=1) +\n  ylab(\"temperature (Celc.)\") +\n  xlab(\"week number\") +\n  scale_color_discrete(name = \"Time series\",\n                       labels = c(\"before 1950\", \"from 2000\"))\n  \n\n```\n\nNow it is your turn to test, for a specific week if the temperatures, from 2000 onward, are on average higher than before 1950.\nYou all have a data set in your project map for a specific week number.\nCheck the average pre 1950 temperature for the same week number in the table below.\n\n\n::: {#exr-climatechange1}\n\nClimate change\n\n* Open a new script, save it under a logical name\n* Write down the H~0~ and the H~1~ as comments in the script\n* write down codes for importing the data set and the one sample t-test.\n* Write down your conclusions as comment in the script.\n\n:::\n\nAverage temperature per week in period 1901-1950:\n```{r, echo=FALSE, message=FALSE, warning=FALSE}\npre1950 %>% \n  mutate(pre1950 = round(pre1950, 2)) %>% \n  knitr::kable() %>% \n  kableExtra::kable_styling(\"striped\") %>% \n  kableExtra::scroll_box(height = \"200px\")\n\n```\n\n\n## Independent t-test\n\nUp to now we have tested one group against a theoretic average.\nBut often you want to compare two groups.\nIn that case you have an **independent** (or **explanatory**) variable, which states to what group the observation belongs.\n\nIn the function `t.test()` you can use as first argument a **statistical formula** instead of a single vector.\nSuch a formula always has the form `dependent ~ independent`.\n\nThe **dependent** (or **response**) variable is the variable you are interested in and which variation you want to explain.\n\nIn the data set bodytemp we have the column **gen** giving the gender of the students.\n\n::: {#exr-independettest}\n\nIndependent t-test\n\n* Test if the average body temperature of male and female students significant differ. Add the code to the bodytemp script\n* Write down the conclusions as comments in your script\n\n:::\n\n\n### Fertilization\n\n\nIn your data map you find a Excel file called bemesting.xlsx.\nIt contains data of an experiments where plant length is measured on plants that were or were not fertilized.\n\n\n\n::: {#exr-fertilization}\n\nFertilization\n\n* Make a new script, give it a logical name\n* Write code that import the bemesting.xlsx file\n* Test if fertilization has an effect on plant length. NB: consider if it makes sense to test one-sided\n* Write down the conclusions as a comment in the script\n  \n:::\n\n\n\n## Paired t-test\n\nWith the independent t-test, you have two groups that are sampled independently from each other, where both groups have a different treatment.\nBut there are situations that you apply two treatments on the same research objects.\n\nFor example, students do a math test before and after drinking a few glasses of beer.\nOf course you expect that the math capacity will decrease after drinking beer.\nThe hypotheses are:\n\n>H~0~: Score before drinking is equal to score after drinking beer.\n\n>H~1~: Score before drinking is higher then score after drinking beer.\n\nUnder the H~0~ you expect that the scores are on average equal before and after drinking.\nWith other words: the difference between before and after is on average 0.\n\nHow can you test that with a t-test?\n\na)    Calculate for each student the difference of both tests\nb)    Apply a one-sample t-test for the difference with $\\mu$=0\n\nBut you can apply both steps at once with a paired t-test, so you don't need to first calculate the difference.\n\nWith paired data it is important that it is clear which observations are paired.\nA good habit is to store paired data on the same row in your Excel spreadsheet:\n\n\n```{r, message = FALSE, warning = FALSE, echo = FALSE}\nlibrary(knitr)\n\nstudent <- 1:5\nbefore <- c(7,4,6,9,5)\nafter <- c(5,4,5,7,5)\nbeer <- data.frame(student, before, after)\nkable(beer, caption = \"Beer experiment\") \n```\n\nThis setup is called a **wide table**.\nThe consequence is that the response variable is not in one column, and therefor you cannot use the standard notation of a statistical formula.\n\nLuckily the function `t.test()` also can handle the input of two vectors: `t.test(x,y)`.\nTo make clear to R that we want to apply a paired t-test, we need to set the argument **paired** to TRUE:\n`t.test(x,y, paired = TRUE)`. \nNB: TRUE needs to be written in capital letters. \nFor lacy people: you also just use the capital letter T.\n\n```{r}\n\n```\n\n\n::: {#exr-beer}\n\nbeer\n\n* make a new script, and write a code to import bier.xlsx (from your data map)\n* import the data, and test if there is an negative effect of beer on the math score (write down your code in the script).\n* Write down your conclusions as a comment in the script.\n\n:::\n\n\n### Macho blackbirds\n\nResearch has indicated that higher testosterone levels have a negative effect on resistance against diseases.\nThis hypothesis is tested in red-winged blackbirds.\nIn thirteen male birds antibody levels were measured before and after placing a testosterone producing implant.\nYou find the data in blackbirds.xlsx in your data map.\n\n\n::: {#exr-blackbirds}\n\nMacho blackbirds\n\n* Test if the implant has a positive effect on antibody production\n* Write down your conclusions in the script\n\n:::\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":true,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"output-file":"W03.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}}}}